% ==============================================================================
% Figure: Mode overlap and I_4 integral visualization
% Shows how profile overlap determines coupling strength
% ==============================================================================

\begin{tikzpicture}[scale=0.90, transform shape]

% === Panel (a): Profile overlap schematic ===
\begin{scope}[shift={(0,0)}]
  \node[font=\small\bfseries] at (3.5,3.5) {(a) Mode profiles and overlap};

  % Axes
  \draw[-{Stealth}, thick] (-0.3,0) -- (7.5,0) node[right, font=\small] {$\xi$};
  \draw[-{Stealth}, thick] (0,-0.3) -- (0,3.0) node[above, font=\small] {$|f|^2$};

  % Left-handed profile (localized near brane)
  \draw[thick, blue!70, domain=0:4, samples=60]
    plot (\x, {2.5*exp(-1.5*(\x-1.2)*(\x-1.2))});
  \fill[blue!20, opacity=0.5, domain=0:4, samples=60]
    plot (\x, {2.5*exp(-1.5*(\x-1.2)*(\x-1.2))}) -- (4,0) -- (0,0) -- cycle;

  % Right-handed profile (broader, extends into bulk)
  \draw[thick, red!70, domain=0:7, samples=60]
    plot (\x, {1.8*exp(-0.4*(\x-2.5)*(\x-2.5))});
  \fill[red!15, opacity=0.4, domain=0:7, samples=60]
    plot (\x, {1.8*exp(-0.4*(\x-2.5)*(\x-2.5))}) -- (7,0) -- (0,0) -- cycle;

  % Overlap region (product)
  \fill[purple!40, opacity=0.6, domain=0:4, samples=60]
    plot (\x, {min(2.5*exp(-1.5*(\x-1.2)*(\x-1.2)), 1.8*exp(-0.4*(\x-2.5)*(\x-2.5)))})
    -- (4,0) -- (0,0) -- cycle;

  % Labels
  \node[font=\small, blue!70!black] at (1.2,2.8) {$|f_L|^2$};
  \node[font=\small, red!70!black] at (4.5,1.6) {$|f_R|^2$};
  \node[font=\scriptsize, purple!70!black] at (1.8,0.8) {overlap};

  % Brane position marker
  \draw[thick, dashed, gray] (0,0) -- (0,3.2);
  \node[font=\scriptsize, gray] at (0.4,3.0) {brane};
\end{scope}

% === Panel (b): I_4 integral ===
\begin{scope}[shift={(9,0)}]
  \node[font=\small\bfseries] at (2.5,3.5) {(b) Overlap integral $I_4$};

  % Axes
  \draw[-{Stealth}, thick] (-0.3,0) -- (5.5,0) node[right, font=\small] {$\xi$};
  \draw[-{Stealth}, thick] (0,-0.3) -- (0,3.0) node[above, font=\small] {$|f_L|^2|f_R|^2$};

  % Product of profiles (quartic)
  \draw[thick, purple!70, domain=0:5, samples=80]
    plot (\x, {2.8*exp(-1.5*(\x-1.2)*(\x-1.2))*exp(-0.4*(\x-2.5)*(\x-2.5))});
  \fill[purple!30, opacity=0.6, domain=0:5, samples=80]
    plot (\x, {2.8*exp(-1.5*(\x-1.2)*(\x-1.2))*exp(-0.4*(\x-2.5)*(\x-2.5))})
    -- (5,0) -- (0,0) -- cycle;

  % I_4 annotation
  \draw[<->, thick, green!50!black] (0.3,0.1) -- (3.5,0.1);
  \node[font=\scriptsize, green!50!black] at (1.9,-0.35) {$I_4 = \int |f_L|^2|f_R|^2\,d\xi$};

  % Peak value
  \draw[dashed, gray] (1.5,0) -- (1.5,2.2);
  \node[font=\scriptsize, gray] at (1.5,-0.6) {$\xi_{\text{peak}}$};
\end{scope}

% === Panel (c): Physical interpretation ===
\begin{scope}[shift={(0,-4.5)}]
  \node[font=\small\bfseries] at (7,1.5) {(c) Physical interpretation};

  % Three scenarios
  % Delta-like (strong coupling)
  \begin{scope}[shift={(0,0)}]
    \draw[thick, purple!70, domain=0:3, samples=50]
      plot (\x, {1.0*exp(-8*(\x-1.5)*(\x-1.5))});
    \fill[purple!30, opacity=0.6, domain=0:3, samples=50]
      plot (\x, {1.0*exp(-8*(\x-1.5)*(\x-1.5))}) -- (3,0) -- (0,0) -- cycle;
    \node[font=\scriptsize] at (1.5,-0.4) {$\delta$-like};
    \node[font=\scriptsize, green!60!black] at (1.5,-0.9) {$I_4 \to \infty$};
    \node[font=\scriptsize] at (1.5,-1.4) {strong};
  \end{scope}

  % Moderate (typical)
  \begin{scope}[shift={(4.5,0)}]
    \draw[thick, purple!70, domain=0:4, samples=50]
      plot (\x, {0.8*exp(-1.5*(\x-2)*(\x-2))});
    \fill[purple!30, opacity=0.6, domain=0:4, samples=50]
      plot (\x, {0.8*exp(-1.5*(\x-2)*(\x-2))}) -- (4,0) -- (0,0) -- cycle;
    \node[font=\scriptsize] at (2,-0.4) {Gaussian};
    \node[font=\scriptsize, orange!70!black] at (2,-0.9) {$I_4 \sim 1$};
    \node[font=\scriptsize] at (2,-1.4) {moderate};
  \end{scope}

  % Uniform (weak coupling)
  \begin{scope}[shift={(9.5,0)}]
    \draw[thick, purple!70] (0,0.3) -- (4,0.3);
    \fill[purple!30, opacity=0.6] (0,0) rectangle (4,0.3);
    \node[font=\scriptsize] at (2,-0.4) {uniform};
    \node[font=\scriptsize, red!60!black] at (2,-0.9) {$I_4 \sim 1/\ell$};
    \node[font=\scriptsize] at (2,-1.4) {weak};
  \end{scope}
\end{scope}

% === Formula box ===
\begin{scope}[shift={(5,-7.5)}]
  \node[draw, rounded corners, fill=blue!5, font=\small, text width=8cm, align=center]
    {$G_F \propto \dfrac{g^2}{m_\phi^2} \cdot I_4$\\[4pt]
     \scriptsize Profile concentration $\Rightarrow$ coupling enhancement};
\end{scope}

\end{tikzpicture}
