% fig_chirality_filter.tex â€” Chirality filter as boundary-condition projection
% Uses styles from tikz_style_edc.tex

\begin{tikzpicture}[edc node distance, scale=0.85, every node/.style={transform shape}]

  % Input modes
  \node[bulk box, text width=2.4cm] (input) at (0,0) {
    \textbf{Brane Modes}\\[2pt]
    \footnotesize $\psi_L$, $\psi_R$\\
    (all chiralities)
  };

  % BC filter
  \node[process box, text width=2.8cm, right=2cm of input] (filter) {
    \textbf{Chirality Filter}\\[2pt]
    \footnotesize $\mathcal{P}_{\mathrm{chir}}$\\
    (boundary conditions)
  };

  % Allowed outputs (split)
  \node[output box, text width=2.2cm, right=2cm of filter, yshift=0.8cm] (lept) {
    \textbf{Charged lepton}\\
    \footnotesize $\ell^-_L$ (left-handed)
  };

  \node[output box, text width=2.2cm, right=2cm of filter, yshift=-0.8cm] (nu) {
    \textbf{Antineutrino}\\
    \footnotesize $\bar\nu_R$ (right-handed)
  };

  % Suppressed modes
  \node[label box, text width=2.0cm, below=1.5cm of filter] (forbid) {
    \footnotesize $\ell^-_R$, $\bar\nu_L$\\
    \textbf{suppressed}\\
    by BC
  };

  % Arrows
  \draw[edc flow] (input) -- node[above, font=\scriptsize] {all modes} (filter);
  \draw[edc arrow] (filter) -- node[above, font=\scriptsize, sloped] {select L} (lept);
  \draw[edc arrow] (filter) -- node[below, font=\scriptsize, sloped] {select R} (nu);
  \draw[edc dashed, red!60!black] (filter) -- (forbid);

  % V-A output annotation
  \node[label box, text width=3.5cm, right=0.5cm of nu, yshift=-0.3cm] (va) {
    \footnotesize\textbf{Result:} V$-$A structure\\
    $\bar\psi_\ell \gamma^\mu (1-\gamma^5) \psi_\nu$
  };
  \draw[gray, dashed] (nu.east) -- (va.west);

\end{tikzpicture}
