% Z_N Symmetry Breaking: One-Defect Robustness Analysis
% File: edc_papers/_shared/derivations/zn_symmetry_breaking_one_defect.tex
% Created: 2026-01-29
% Purpose: Quantify harmonic contamination when one anchor has different strength
%
% EPISTEMIC STATUS:
%   [Der] - Perturbation theory framework and O(ε²) scaling
%   [Dc]  - Precise coefficients in some estimates
%
% PREREQUISITE: zn_ring_delta_pinning_modes.tex, zn_strong_pinning_regimes.tex
% COMPANION: docs/ZN_ONE_DEFECT_ROBUSTNESS_NOTE.md

\documentclass[11pt]{article}
\usepackage{amsmath,amssymb,amsthm}
\usepackage[margin=1in]{geometry}
\usepackage{tcolorbox}
\usepackage{booktabs}
\usepackage{array}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}

% Epistemic tags
\newcommand{\tagDer}{\textcolor{blue}{\textbf{[Der]}}}
\newcommand{\tagDc}{\textcolor{green!60!black}{\textbf{[Dc]}}}
\newcommand{\tagP}{\textcolor{orange}{\textbf{[P]}}}

\title{Z$_N$ Symmetry Breaking:\\[0.5em]
\large One-Defect Robustness Analysis}
\author{EDC Project}
\date{2026-01-29}

\begin{document}
\maketitle

\begin{abstract}
We analyze the robustness of the $\cos(N\theta)$ mode selection when Z$_N$ symmetry
is weakly broken by one anchor having a different strength. Using standard
perturbation theory, we show that the overlap with the pure $\cos(N\theta)$ mode
decreases as $O(\varepsilon^2)$ where $\varepsilon = \Delta\lambda/\lambda$ is the
relative strength mismatch. We derive tolerance bounds for maintaining $>99\%$
overlap and classify the failure mode when $\varepsilon \sim O(1)$.
\end{abstract}

\tableofcontents
\newpage

%============================================================
\section{Perturbed Operator}
%============================================================

\subsection{Setup}

\begin{definition}[Symmetric Operator] \tagDer
\label{def:L0}
The Z$_N$-symmetric operator with identical anchors of strength $\lambda$:
\begin{equation}
\mathcal{L}_0 = -T \frac{d^2}{d\theta^2} + \lambda\kappa \sum_{n=0}^{N-1} \delta(\theta - \theta_n) P_n
\label{eq:L0}
\end{equation}
where $\theta_n = 2\pi n/N$ and $P_n$ is evaluation at $\theta_n$.
\end{definition}

\begin{definition}[One-Defect Perturbation] \tagDer
\label{def:perturbation}
Let one anchor (at position $n^* = 0$ without loss of generality) have strength
$\lambda(1 + \varepsilon)$ instead of $\lambda$. The perturbed operator is:
\begin{equation}
\mathcal{L} = \mathcal{L}_0 + \varepsilon \, \Delta\mathcal{L}
\label{eq:L_perturbed}
\end{equation}
where the perturbation is:
\begin{equation}
\boxed{\Delta\mathcal{L} = \lambda\kappa \, \delta(\theta - \theta_0) \, P_0}
\label{eq:DeltaL}
\end{equation}
This is a \textbf{localized perturbation} at the defect site $\theta_0 = 0$.
\end{definition}

\subsection{Physical Interpretation}

The perturbation $\varepsilon$ represents:
\begin{itemize}
\item $\varepsilon > 0$: defect is \textbf{stronger} than average (deeper pinning)
\item $\varepsilon < 0$: defect is \textbf{weaker} than average (shallower pinning)
\item $\varepsilon = 0$: perfect Z$_N$ symmetry (identical anchors)
\end{itemize}

%============================================================
\section{Unperturbed Eigenmodes}
%============================================================

\subsection{Mode Structure Recap}

From the Z$_N$-symmetric analysis (see \texttt{zn\_ring\_delta\_pinning\_modes.tex}):

\begin{proposition}[Unperturbed Spectrum] \tagDer
\label{prop:unperturbed}
The eigenmodes of $\mathcal{L}_0$ are:
\begin{align}
\text{Constant mode:} \quad &\psi_0 = 1, \quad \mu_0 = 0 \\
\text{Non-coupled modes:} \quad &\psi_m^{(c)} = \cos(m\theta), \quad \mu_m = Tm^2 \quad (m \not\equiv 0 \mod N) \\
\text{Z$_N$-coupled modes:} \quad &\psi_{kN}^{(c)} = \cos(kN\theta), \quad \mu_{kN} = T(kN)^2 + \frac{\rho N}{\pi}
\end{align}
where $\rho = \lambda\kappa/T$ is the dimensionless pinning strength.

For each $m > 0$, there is also $\psi_m^{(s)} = \sin(m\theta)$ with the same eigenvalue.
\end{proposition}

\begin{corollary}[Target Mode] \tagDer
\label{cor:target}
The leading anisotropic mode of interest is:
\begin{equation}
\psi_N(\theta) = \sqrt{\frac{1}{\pi}} \cos(N\theta), \quad \mu_N = TN^2 + \frac{\rho N}{\pi}
\label{eq:psi_N}
\end{equation}
(normalized on $[0, 2\pi]$).
\end{corollary}

%============================================================
\section{Perturbation Theory}
%============================================================

\subsection{First-Order Wavefunction Correction}

\begin{theorem}[Wavefunction Mixing] \tagDer
\label{thm:mixing}
To first order in $\varepsilon$, the perturbed eigenmode is:
\begin{equation}
|\tilde{\psi}_N\rangle = |\psi_N\rangle + \varepsilon \sum_{m \neq N} \frac{\langle \psi_m | \Delta\mathcal{L} | \psi_N \rangle}{\mu_N - \mu_m} |\psi_m\rangle + O(\varepsilon^2)
\label{eq:first_order}
\end{equation}
where the sum runs over all other eigenmodes $\psi_m$ (both cosine and sine).
\end{theorem}

\subsection{Matrix Elements}

\begin{proposition}[Defect Coupling] \tagDer
\label{prop:matrix_elements}
For the localized perturbation $\Delta\mathcal{L} = \lambda\kappa \, \delta(\theta) P_0$:
\begin{align}
\langle \psi_m^{(c)} | \Delta\mathcal{L} | \psi_N \rangle &= \frac{\lambda\kappa}{\pi} \cos(m \cdot 0) \cos(N \cdot 0) = \frac{\lambda\kappa}{\pi} = \frac{\rho T}{\pi}
\label{eq:cos_coupling} \\
\langle \psi_m^{(s)} | \Delta\mathcal{L} | \psi_N \rangle &= \frac{\lambda\kappa}{\pi} \sin(m \cdot 0) \cos(N \cdot 0) = 0
\label{eq:sin_coupling}
\end{align}
\end{proposition}

\begin{proof}
For normalized modes $\psi_m^{(c)} = \sqrt{1/\pi}\cos(m\theta)$ and the delta at $\theta = 0$:
\begin{equation}
\langle \psi_m^{(c)} | \delta(\theta) | \psi_N \rangle = \psi_m^{(c)}(0) \cdot \psi_N(0) = \frac{1}{\pi} \cdot 1 \cdot 1 = \frac{1}{\pi}
\end{equation}
For sine modes, $\sin(m \cdot 0) = 0$, so they don't couple at $\theta_0 = 0$.
\end{proof}

\begin{corollary}[Only Cosine Contamination] \tagDer
\label{cor:cos_only}
When the defect is at $\theta_0 = 0$, only cosine modes $\cos(m\theta)$ get mixed in.
Sine modes are unaffected (their coupling is zero).
\end{corollary}

\subsection{Mixing Coefficients}

\begin{definition}[Contamination Amplitude] \tagDer
\label{def:c_m}
The mixing coefficient for mode $m$ is:
\begin{equation}
c_m = \varepsilon \cdot \frac{\langle \psi_m | \Delta\mathcal{L} | \psi_N \rangle}{\mu_N - \mu_m}
\label{eq:c_m_def}
\end{equation}
\end{definition}

\begin{proposition}[Explicit Contamination] \tagDer
\label{prop:c_m_explicit}
For cosine modes with $m \neq N$:
\begin{equation}
\boxed{c_m = \varepsilon \cdot \frac{\rho}{\pi(N^2 - m^2 + \Delta\mu_N/T)}}
\label{eq:c_m}
\end{equation}
where $\Delta\mu_N/T = \rho N/(\pi T) \cdot T/T = \rho N/\pi$ for Z$_N$-coupled modes.

For modes with $m \not\equiv 0 \pmod{N}$ (non-coupled in the unperturbed problem):
\begin{equation}
c_m \approx \varepsilon \cdot \frac{\rho}{\pi(N^2 - m^2)} \quad \text{(valid for } |N^2 - m^2| \gg \rho N/\pi)
\label{eq:c_m_approx}
\end{equation}
\end{proposition}

%============================================================
\section{Overlap Loss}
%============================================================

\subsection{Quadratic Scaling}

\begin{theorem}[Overlap Loss Formula] \tagDer
\label{thm:overlap_loss}
The squared overlap between the perturbed mode and the unperturbed $\cos(N\theta)$ is:
\begin{equation}
|\langle \psi_N | \tilde{\psi}_N \rangle|^2 = 1 - \sum_{m \neq N} |c_m|^2 + O(\varepsilon^3)
\label{eq:overlap_sq}
\end{equation}

Therefore the \textbf{overlap loss} is:
\begin{equation}
\boxed{1 - |\langle \psi_N | \tilde{\psi}_N \rangle|^2 = \sum_{m \neq N} |c_m|^2 = O(\varepsilon^2)}
\label{eq:loss_O_eps2}
\end{equation}
\end{theorem}

\begin{proof}
To first order, $|\tilde{\psi}_N\rangle = |\psi_N\rangle + \varepsilon \sum_m c_m' |\psi_m\rangle$ where
$c_m' = c_m/\varepsilon$. Then:
\begin{align}
\langle \tilde{\psi}_N | \tilde{\psi}_N \rangle &= 1 + \varepsilon^2 \sum_m |c_m'|^2 + O(\varepsilon^3) \\
\langle \psi_N | \tilde{\psi}_N \rangle &= 1 + O(\varepsilon^2)
\end{align}
The normalized overlap squared gives the result.
\end{proof}

\subsection{Sum Over Modes}

\begin{proposition}[Contamination Sum] \tagDc
\label{prop:sum}
The total contamination is:
\begin{equation}
\sum_{m \neq N} |c_m|^2 = \varepsilon^2 \cdot \frac{\rho^2}{\pi^2} \sum_{m=1}^{\infty} \frac{1}{(N^2 - m^2)^2} \cdot \mathbf{1}_{m \neq N}
\label{eq:sum_contamination}
\end{equation}

For $N \gg 1$, the dominant contributions come from $m$ near $N$:
\begin{equation}
\sum_{m \neq N} \frac{1}{(N^2 - m^2)^2} \approx \sum_{k=1}^{N-1} \frac{1}{(2Nk - k^2)^2} + \sum_{k=1}^{\infty} \frac{1}{(2Nk + k^2)^2}
\end{equation}

\textbf{Crude upper bound:}
\begin{equation}
\sum_{m \neq N} |c_m|^2 \lesssim \varepsilon^2 \cdot \frac{\rho^2}{\pi^2} \cdot \frac{\pi^2}{6N^4} = \varepsilon^2 \cdot \frac{\rho^2}{6N^4}
\label{eq:upper_bound}
\end{equation}
\end{proposition}

%============================================================
\section{Tolerance Theorem}
%============================================================

\begin{tcolorbox}[colback=green!10!white, colframe=green!60!black,
                  title=\textbf{Tolerance Theorem}]

\begin{theorem}[99\% Overlap Threshold] \tagDer
\label{thm:tolerance}
For the perturbed mode to maintain $>99\%$ squared overlap with $\cos(N\theta)$:
\begin{equation}
\boxed{|\varepsilon| < \varepsilon_{99} \approx \frac{0.1 \cdot N^2}{\rho} \cdot C_N}
\label{eq:eps_99}
\end{equation}
where $C_N \sim O(1)$ is a geometric factor depending on $N$.

\textbf{Scaling:}
\begin{itemize}
\item $\varepsilon_{99} \propto N^2$ (more anchors $\Rightarrow$ more robust)
\item $\varepsilon_{99} \propto 1/\rho$ (stronger pinning $\Rightarrow$ less robust)
\end{itemize}

\textbf{Practical estimates:}
\begin{center}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|c|c|c|}
\hline
\textbf{Regime} & \textbf{Condition} & \textbf{Typical $\varepsilon_{99}$} \\
\hline
Weak pinning & $\rho \ll N^2$ & $\varepsilon_{99} \gtrsim 1$ (always robust) \\
\hline
Moderate & $\rho \sim N^2$ & $\varepsilon_{99} \sim 0.1$--$0.3$ \\
\hline
Strong pinning & $\rho \gg N^2$ & $\varepsilon_{99} \sim N^2/\rho \ll 1$ \\
\hline
\end{tabular}
\end{center}
\end{theorem}
\end{tcolorbox}

%============================================================
\section{Which Harmonics Get Contaminated?}
%============================================================

\subsection{Defect-Induced Coupling}

\begin{proposition}[Contamination Spectrum] \tagDer
\label{prop:spectrum}
When the defect is at $\theta_0 = 0$:
\begin{itemize}
\item \textbf{All} cosine modes $\cos(m\theta)$ with $m \neq N$ receive contamination
\item The amplitude is $|c_m| \propto 1/|N^2 - m^2|$
\item \textbf{Dominant contamination}: $m = N \pm 1$ (nearest neighbors)
\item \textbf{Next}: $m = N \pm 2$, etc.
\end{itemize}

The contamination is \textbf{not} restricted to Z$_N$-symmetric harmonics!
\end{proposition}

\begin{corollary}[Breaking of Selection Lemma] \tagDer
\label{cor:breaking}
Under perfect Z$_N$ symmetry, only $m = kN$ modes couple to anchors.

With one defect, this selection rule is \textbf{violated}: modes like
$\cos((N\pm 1)\theta)$, $\cos((N\pm 2)\theta)$, etc.\ acquire nonzero amplitude.

However, the violation is $O(\varepsilon)$ in amplitude, i.e., $O(\varepsilon^2)$ in probability.
\end{corollary}

\subsection{Defect Position Dependence}

\begin{proposition}[General Defect Position] \tagDc
\label{prop:position}
If the defect is at position $\theta_0 \neq 0$, the coupling becomes:
\begin{equation}
\langle \psi_m^{(c)} | \Delta\mathcal{L} | \psi_N \rangle \propto \cos(m\theta_0) \cos(N\theta_0)
\end{equation}

For $\theta_0 = 2\pi k/N$ (at a Z$_N$ fixed point), $\cos(N\theta_0) = 1$,
so the structure is qualitatively similar.

For generic $\theta_0$, the pattern of contaminated harmonics shifts but the
scaling $O(\varepsilon^2)$ remains unchanged.
\end{proposition}

%============================================================
\section{Failure Mode: Large $\varepsilon$}
%============================================================

\subsection{When Perturbation Theory Breaks Down}

\begin{proposition}[Breakdown Criterion] \tagDer
\label{prop:breakdown}
Perturbation theory is valid when:
\begin{equation}
|c_m| \ll 1 \quad \text{for all } m
\label{eq:validity}
\end{equation}

The largest contamination is for $m = N - 1$:
\begin{equation}
|c_{N-1}| \sim \varepsilon \cdot \frac{\rho}{\pi(2N - 1)} \approx \varepsilon \cdot \frac{\rho}{2\pi N}
\end{equation}

Breakdown occurs when $|c_{N-1}| \sim 1$, i.e.:
\begin{equation}
\boxed{|\varepsilon| \sim \frac{2\pi N}{\rho}}
\label{eq:breakdown}
\end{equation}
\end{proposition}

\subsection{Strong Breaking Regime}

\begin{proposition}[Mode Reorganization] \tagDc
\label{prop:strong_breaking}
When $|\varepsilon| \sim O(1)$:
\begin{itemize}
\item The eigenmodes are \textbf{no longer} approximately $\cos(N\theta)$
\item The mode structure reorganizes around the asymmetric anchor configuration
\item The ``dominant mode'' may shift to a different effective periodicity
\item Z$_N$ selection is completely broken
\end{itemize}

\textbf{Example (numeric):} For $N = 6$, $\rho = 10$, $\varepsilon = 1$:
the leading mode has $\sim 60\%$ overlap with $\cos(6\theta)$, with
significant contamination from $m = 5, 7, 4, 8, \ldots$
\end{proposition}

%============================================================
\section{Summary}
%============================================================

\begin{tcolorbox}[colback=blue!5!white, colframe=blue!50!black,
                  title=\textbf{Main Results}]

\textbf{1. Perturbative regime} ($|\varepsilon| \ll 1$):
\begin{itemize}
\item Overlap loss scales as $O(\varepsilon^2)$ \tagDer
\item All cosine harmonics get contaminated (not just $m = kN$)
\item Dominant contamination from $m = N \pm 1$
\end{itemize}

\textbf{2. Tolerance threshold:}
\begin{equation}
\varepsilon_{99} \sim \frac{N^2}{\rho} \times O(0.1)
\end{equation}

\textbf{3. Scaling with parameters:}
\begin{itemize}
\item More anchors ($\uparrow N$) $\Rightarrow$ more robust
\item Stronger pinning ($\uparrow \rho$) $\Rightarrow$ less robust (more sensitive to defects)
\end{itemize}

\textbf{4. Failure mode:}
When $|\varepsilon| \gtrsim 2\pi N/\rho$, perturbation theory breaks down
and Z$_N$ selection is lost.

\end{tcolorbox}

%============================================================
\section{Epistemic Status}
%============================================================

\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|l|l|p{5.5cm}|}
\hline
\textbf{Result} & \textbf{Status} & \textbf{Comment} \\
\hline
\hline
Perturbation framework & \tagDer & Standard quantum mechanics \\
\hline
$O(\varepsilon^2)$ overlap loss scaling & \tagDer & Follows from first-order PT \\
\hline
Matrix element calculation & \tagDer & Direct evaluation \\
\hline
Tolerance threshold formula & \tagDc & Scaling derived, coefficient approximate \\
\hline
Contamination sum bounds & \tagDc & Upper bound; exact sum not computed \\
\hline
Failure mode description & \tagDc & Qualitative; numerical verification needed \\
\hline
\end{tabular}

\vspace{1em}
\textbf{Central result ($O(\varepsilon^2)$ scaling) is fully derived [Der].}

Practical thresholds require numerical verification [Dc].

\end{document}
